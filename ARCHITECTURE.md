# é¡¹ç›®ç»“æ„å¯è§†åŒ–

## ğŸ“ å®Œæ•´ç›®å½•ç»“æ„

```
Codex Mate/
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.tsx                      # React åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ styles.css                    # å…¨å±€æ ·å¼æ–‡ä»¶
â”‚   â”œâ”€â”€ types.ts                      # TypeScript ç±»å‹å®šä¹‰
â”‚   â”‚
â”‚   â”œâ”€â”€ config/                       # é…ç½®æ–‡ä»¶
â”‚   â”‚   â””â”€â”€ menuConfig.tsx            # èœå•é…ç½®
â”‚   â”‚
â”‚   â”œâ”€â”€ hooks/                        # è‡ªå®šä¹‰ Hooks
â”‚   â”‚   â””â”€â”€ index.ts                  # ç»Ÿä¸€å¯¼å‡ºæ‰€æœ‰ Hooks
â”‚   â”‚
â”‚   â”œâ”€â”€ utils/                        # å·¥å…·å‡½æ•°
â”‚   â”‚   â””â”€â”€ index.ts                  # å·¥å…·å‡½æ•°é›†åˆ
â”‚   â”‚
â”‚   â””â”€â”€ ui/                           # UI ç»„ä»¶
â”‚       â”œâ”€â”€ App.tsx                   # ä¸»åº”ç”¨ç»„ä»¶
â”‚       â”‚
â”‚       â”œâ”€â”€ components/               # å¯å¤ç”¨ç»„ä»¶
â”‚       â”‚   â”œâ”€â”€ Common.tsx            # é€šç”¨ç»„ä»¶ï¼ˆMessageã€Loadingã€ErrorMessageï¼‰
â”‚       â”‚   â”œâ”€â”€ Layout.tsx            # å¸ƒå±€å®¹å™¨
â”‚       â”‚   â”œâ”€â”€ MainContent.tsx       # ä¸»å†…å®¹åŒºç»„ä»¶
â”‚       â”‚   â””â”€â”€ Sidebar.tsx           # ä¾§è¾¹æ ç»„ä»¶
â”‚       â”‚
â”‚       â””â”€â”€ pages/                    # é¡µé¢ç»„ä»¶
â”‚           â”œâ”€â”€ ConfigEditor.tsx      # é…ç½®æ–‡ä»¶ç¼–è¾‘é¡µé¢
â”‚           â”œâ”€â”€ Mcp.tsx               # MCP æœåŠ¡å™¨ç®¡ç†é¡µé¢
â”‚           â”œâ”€â”€ Nodes.tsx             # èŠ‚ç‚¹ç®¡ç†é¡µé¢
â”‚           â”œâ”€â”€ Projects.tsx          # é¡¹ç›®ä¿¡ä»»ç®¡ç†é¡µé¢
â”‚           â””â”€â”€ Settings.tsx          # è®¾ç½®é¡µé¢
â”‚
â”œâ”€â”€ src-tauri/                        # Tauri åç«¯
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â””â”€â”€ main.rs                   # Rust ä¸»ç¨‹åº
â”‚   â”œâ”€â”€ Cargo.toml                    # Rust ä¾èµ–é…ç½®
â”‚   â””â”€â”€ tauri.conf.json               # Tauri é…ç½®
â”‚
â”œâ”€â”€ index.html                        # HTML å…¥å£
â”œâ”€â”€ package.json                      # npm ä¾èµ–é…ç½®
â”œâ”€â”€ pnpm-lock.yaml                    # pnpm é”æ–‡ä»¶
â”œâ”€â”€ tsconfig.json                     # TypeScript é…ç½®
â”œâ”€â”€ vite.config.ts                    # Vite é…ç½®
â”œâ”€â”€ REFACTOR.md                       # é‡æ„è¯´æ˜æ–‡æ¡£
â””â”€â”€ README.md                         # é¡¹ç›®è¯´æ˜
```

## ğŸ”„ æ•°æ®æµå›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         App.tsx                              â”‚
â”‚  - çŠ¶æ€ç®¡ç†ï¼šactiveMenu                                       â”‚
â”‚  - æ¸²æŸ“ï¼šLayout + Sidebar + MainContent                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚                 â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   Sidebar       â”‚  â”‚   MainContent        â”‚
         â”‚  - èœå•åˆ—è¡¨      â”‚  â”‚  - å½“å‰é¡µé¢æ ‡é¢˜      â”‚
         â”‚  - æ¿€æ´»çŠ¶æ€      â”‚  â”‚  - åŠ¨æ€æ¸²æŸ“é¡µé¢ç»„ä»¶  â”‚
         â”‚  - ç‚¹å‡»åˆ‡æ¢      â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
                                         â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                                           â”‚
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚  Page Component â”‚                        â”‚  Page Component â”‚
           â”‚  - ä¸šåŠ¡é€»è¾‘      â”‚                        â”‚  - ä¸šåŠ¡é€»è¾‘      â”‚
           â”‚  - çŠ¶æ€ç®¡ç†      â”‚                        â”‚  - çŠ¶æ€ç®¡ç†      â”‚
           â”‚  - API è°ƒç”¨      â”‚                        â”‚  - API è°ƒç”¨      â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚                                          â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚   Custom Hooks          â”‚
                          â”‚  - useAsyncAction       â”‚
                          â”‚  - useFormState         â”‚
                          â”‚  - useLoadingState      â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚   Tauri Invoke          â”‚
                          â”‚  - read_config_raw      â”‚
                          â”‚  - list_mcp_servers     â”‚
                          â”‚  - list_nodes           â”‚
                          â”‚  - ...                  â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¨ ç»„ä»¶å±‚æ¬¡ç»“æ„

```
App
â””â”€â”€ Layout
    â”œâ”€â”€ Sidebar
    â”‚   â””â”€â”€ NavItem (å¤šä¸ª)
    â”‚       â””â”€â”€ activeMenu é«˜äº®æ˜¾ç¤º
    â”‚
    â””â”€â”€ MainContent
        â””â”€â”€ CurrentPageComponent
            â”œâ”€â”€ Card (å¤šä¸ª)
            â”‚   â”œâ”€â”€ CardHeader
            â”‚   â””â”€â”€ CardBody
            â”‚       â”œâ”€â”€ Form
            â”‚       â”‚   â”œâ”€â”€ Input
            â”‚       â”‚   â”œâ”€â”€ Select
            â”‚       â”‚   â””â”€â”€ Button
            â”‚       â”‚
            â”‚       â”œâ”€â”€ Table
            â”‚       â”‚   â”œâ”€â”€ TableHeader
            â”‚       â”‚   â””â”€â”€ TableRow (å¤šä¸ª)
            â”‚       â”‚       â””â”€â”€ Actions
            â”‚       â”‚
            â”‚       â””â”€â”€ Messages
            â”‚           â”œâ”€â”€ Loading
            â”‚           â”œâ”€â”€ ErrorMessage
            â”‚           â””â”€â”€ Message (success/error/info/warning)
            â”‚
            â””â”€â”€ Common Components
                â”œâ”€â”€ Loading
                â”œâ”€â”€ Message
                â””â”€â”€ ErrorMessage
```

## ğŸ”Œ Hooks ä¾èµ–å…³ç³»

```
useAsyncAction
â”œâ”€â”€ useLoadingState
â”‚   â””â”€â”€ useState (loading, error, success)
â””â”€â”€ execute å‡½æ•°
    â””â”€â”€ setLoadingState

useFormState
â”œâ”€â”€ useState (form)
â””â”€â”€ è¿”å›
    â”œâ”€â”€ form (å½“å‰è¡¨å•çŠ¶æ€)
    â”œâ”€â”€ updateField (æ›´æ–°å•ä¸ªå­—æ®µ)
    â”œâ”€â”€ updateForm (æ›´æ–°æ•´ä¸ªè¡¨å•)
    â””â”€â”€ resetForm (é‡ç½®è¡¨å•)

useInvoke
â”œâ”€â”€ useState (data, loading, error)
â”œâ”€â”€ useCallback (fetch)
â””â”€â”€ invoke (Tauri API)
```

## ğŸ¯ é¡µé¢ç»„ä»¶åŠŸèƒ½æ˜ å°„

```
ConfigEditor (é…ç½®æ–‡ä»¶)
â”œâ”€â”€ åŠŸèƒ½ï¼šç¼–è¾‘ config.toml
â”œâ”€â”€ APIï¼šread_config_raw, write_config_raw
â””â”€â”€ ç»„ä»¶ï¼šTextarea + ä¿å­˜/é‡è½½æŒ‰é’®

Mcp (MCP ç®¡ç†)
â”œâ”€â”€ åŠŸèƒ½ï¼šç®¡ç† MCP æœåŠ¡å™¨
â”œâ”€â”€ APIï¼šlist_mcp_servers, upsert_mcp_server, delete_mcp_server
â””â”€â”€ ç»„ä»¶ï¼šForm + Table + è¡Œå†…ç¼–è¾‘

Nodes (èŠ‚ç‚¹ç®¡ç†)
â”œâ”€â”€ åŠŸèƒ½ï¼šç®¡ç† AI èŠ‚ç‚¹
â”œâ”€â”€ APIï¼šlist_nodes, upsert_node, switch_node, delete_node, update_node_credential
â””â”€â”€ ç»„ä»¶ï¼šForm + Table + å‡­æ®ç®¡ç†

Projects (é¡¹ç›®ä¿¡ä»»)
â”œâ”€â”€ åŠŸèƒ½ï¼šç®¡ç†é¡¹ç›®ä¿¡ä»»çº§åˆ«
â”œâ”€â”€ APIï¼šlist_projects, upsert_project, delete_project
â””â”€â”€ ç»„ä»¶ï¼šForm + Table + è¡Œå†…ç¼–è¾‘

Settings (è®¾ç½®)
â”œâ”€â”€ åŠŸèƒ½ï¼šæ£€æµ‹ Codex CLI
â”œâ”€â”€ APIï¼šget_codex_version
â””â”€â”€ ç»„ä»¶ï¼šæ£€æµ‹æŒ‰é’® + çŠ¶æ€æ˜¾ç¤º
```

## ğŸ› ï¸ å·¥å…·å‡½æ•°ç”¨é€”

```
utils/index.ts
â”œâ”€â”€ debounce          - è¾“å…¥é˜²æŠ–
â”œâ”€â”€ throttle          - äº‹ä»¶èŠ‚æµ
â”œâ”€â”€ validateRequired  - è¡¨å•éªŒè¯
â”œâ”€â”€ parseCommaSeparated - è§£æå‚æ•°
â”œâ”€â”€ arrayToCommaSeparated - æ ¼å¼åŒ–å‚æ•°
â”œâ”€â”€ formatError       - é”™è¯¯æ ¼å¼åŒ–
â”œâ”€â”€ deepClone         - å¯¹è±¡æ·±æ‹·è´
â””â”€â”€ delay             - å»¶è¿Ÿæ‰§è¡Œ
```

## ğŸ¨ æ ·å¼ç³»ç»Ÿæ¶æ„

```
styles.css
â”œâ”€â”€ CSS Variables (è®¾è®¡ tokens)
â”‚   â”œâ”€â”€ é¢œè‰²ç³»ç»Ÿ
â”‚   â”œâ”€â”€ é—´è·ç³»ç»Ÿ
â”‚   â”œâ”€â”€ é˜´å½±ç³»ç»Ÿ
â”‚   â””â”€â”€ è¾¹æ¡†ç³»ç»Ÿ
â”‚
â”œâ”€â”€ å…¨å±€æ ·å¼
â”‚   â”œâ”€â”€ Reset
â”‚   â””â”€â”€ Body
â”‚
â”œâ”€â”€ å¸ƒå±€ç»„ä»¶
â”‚   â”œâ”€â”€ .app-container
â”‚   â”œâ”€â”€ .sidebar
â”‚   â””â”€â”€ .main-content
â”‚
â”œâ”€â”€ UI ç»„ä»¶
â”‚   â”œâ”€â”€ .card
â”‚   â”œâ”€â”€ .btn (åŠå…¶å˜ä½“)
â”‚   â”œâ”€â”€ .form-group
â”‚   â”œâ”€â”€ .table
â”‚   â”œâ”€â”€ .message
â”‚   â””â”€â”€ .badge
â”‚
â””â”€â”€ å·¥å…·ç±»
    â”œâ”€â”€ .loading
    â”œâ”€â”€ .error-message
    â””â”€â”€ å“åº”å¼æ ·å¼
```

## ğŸ“Š çŠ¶æ€ç®¡ç†æµç¨‹

```
ç”¨æˆ·æ“ä½œ
  â”‚
  â–¼
è§¦å‘ Handler
  â”‚
  â–¼
execute (useAsyncAction)
  â”‚
  â”œâ”€â–º setLoadingState(true)
  â”‚
  â”œâ”€â–º invoke (Tauri API)
  â”‚     â”‚
  â”‚     â”œâ”€â–º æˆåŠŸ
  â”‚     â”‚     â””â”€â–º setLoadingState(false, null, successMsg)
  â”‚     â”‚
  â”‚     â””â”€â–º å¤±è´¥
  â”‚           â””â”€â–º setLoadingState(false, error, null)
  â”‚
  â””â”€â–º æ›´æ–° UI
        â”œâ”€â–º Loading ç»„ä»¶
        â”œâ”€â–º Message ç»„ä»¶
        â””â”€â–º ErrorMessage ç»„ä»¶
```

---

è¿™ä¸ªå¯è§†åŒ–æ–‡æ¡£æ¸…æ™°åœ°å±•ç¤ºäº†é¡¹ç›®çš„ç»“æ„ã€æ•°æ®æµã€ç»„ä»¶å±‚æ¬¡å’Œå„ä¸ªæ¨¡å—çš„èŒè´£å…³ç³»ã€‚
